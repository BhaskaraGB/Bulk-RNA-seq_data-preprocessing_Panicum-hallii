# 3'-mRNA seq (tag-seq) analysis. 

This pipeline is designed to preprocess RNA sequencing data that is generated by tag-Seq, or Tag-based RNA sequencing, a technique used to profile gene expression by sequencing short tags from the 3' ends of transcripts.

The scripts are designed to be run in a Conda environment.

## 00-qual_report

This directory contains three scripts that are used for generating quality reports on raw FASTQ files. 

1. *concat.sh*:
   - Finds all FASTQ files corresponding to each sample, concatenates them, and prepares them for quality analysis.

3. *run_fastqc.sh*:
   - Runs the FastQC tool on all raw FASTQ files in the directory, generates HTML and QC reports for each file.

5. *fastqc_data_txt.sh*:
   - Processes the FASTQC output files to extract relevant quality metrics and summary statistics.

---

## 01-qual_filter

The scripts are designed to perform trimming, quality filtering, and subsequent quality control (QC) reporting. 

1. *cutadapt.sh*:
   - Trims adapters and low-quality bases from the FASTQ files.
  

2. *QC_qual_filter.sh*:
   - Extracting quality report for the trimmed FASTQ files.
 
3. *fastqc_data_txt.sh*:
   - Processes the FastQC output files to extract relevant quality metrics and summary statistics after filtering.

---

## 02-mapping

This directory contains a script for aligning sequencing reads to a reference genome using the BWA-MEM algorithm. The script is designed to perform read alignment, generating aligned sequences in SAM format. 

1. *bwa-mem.sh*:
   - This script takes raw or preprocessed FASTQ files and aligns them to a specified reference genome, outputting the results in SAM format for further analysis.

---

## 03-map-filter

This directory contains scripts for converting SAM files to BAM format, filtering and sorting BAM files, marking duplicates, and generating mapping statistics.

1. *samtoolsfilter.sh*:
   - Converts SAM files to BAM format, filters out reads with a mapping quality less than 30, and sorts the BAM files.

2. *markdup.sh*:
   - Utilizes Picard tool to identify and mark duplicate reads, which can result from PCR amplification during library preparation. 

3. *map-stat.sh*:
   - Uses SAMtools flagstat function to produce comprehensive mapping statistics for the filtered and duplicate-marked BAM files. 

---

## 04-count

This directory contains a script `featureCount.sh` for counting the number of mapped reads in RNA-seq data using the featureCounts tool.

*featureCount.sh*:
- Uses the featureCounts tool to count the number of mapped reads for each gene in the provided BAM files and generates a count table, essential for subsequent differential expression analysis.

 **FeatureCounts Parameters**:
   - **Annotation File**: The script uses a gene annotation file in GFF3 format to identify gene locations.
   - **Read Extensions**: No extensions are applied to the reads (both 5' and 3' extensions are set to 0).
   - **Strand Specificity**: The script considers the strand-specific information.
   - **Quality Filtering**: Only primary alignments are counted, and duplicate reads are ignored.
   - **Additional Parameters**: Includes options for read quality filtering, minimum fragment length, and the number of threads for parallel processing.

**Output**:
   - For each BAM file, a count table is generated and saved in the counts directory. The count table contains the read counts for each gene, which can be used for downstream differential expression analysis.
